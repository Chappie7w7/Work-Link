{% import "components/navbar.jinja2" as navbar %}
{% import "components/footer.jinja2" as footer %}
{% import "components/flash_messages.jinja2" as flash %}

<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inicio - Worklink</title>
    
    <!-- PWA Meta Tags -->
    <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
    <meta name="theme-color" content="#2563eb">
    <link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='icons/icon-192x192.png') }}">
    <link rel="icon" type="image/png" sizes="192x192" href="{{ url_for('static', filename='icons/icon-192x192.png') }}">
    <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='icons/icon-192x192.png') }}">
    
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style_inicio.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
{{ navbar.navbar(current_user) }}
{{ flash.render_flash_messages() }}

    <!-- Hero Section -->
    <section class="hero-section" data-aos="fade-up" data-aos-delay="50">
        <div class="hero-content" data-aos="fade-up" data-aos-delay="100">
            <h1 class="hero-title">Encuentra tu trabajo ideal en <span class="gradient-text">Ocosingo</span></h1>
            <p class="hero-subtitle">Conectamos talento con oportunidades. Tu próximo paso profesional comienza aquí.</p>
            <div class="hero-cta">
                <a href="{{ url_for('EmpleosRoute.empleos') }}" class="btn-primary">
                    <i class="fas fa-search"></i> Explorar Empleos
                </a>
                <a href="{{ url_for('PlanesRoute.planes') }}" class="btn-secondary">
                    <i class="fas fa-rocket"></i> Ver Planes
                </a>
            </div>
        </div>
        <div class="hero-stats">
            <div class="stat-card" data-aos="fade-up" data-aos-delay="150">
                <div class="stat-icon blue">
                    <i class="fas fa-building"></i>
                </div>
                <div class="stat-content">
                    <div class="stat-number">{{ total_empresas if total_empresas else 0 }}+</div>
                    <div class="stat-label">Empresas</div>
                </div>
            </div>
            <div class="stat-card" data-aos="fade-up" data-aos-delay="200">
                <div class="stat-icon green">
                    <i class="fas fa-users"></i>
                </div>
                <div class="stat-content">
                    <div class="stat-number">{{ total_usuarios if total_usuarios else 0 }}+</div>
                    <div class="stat-label">Usuarios</div>
                </div>
            </div>
            <div class="stat-card" data-aos="fade-up" data-aos-delay="250">
                <div class="stat-icon purple">
                    <i class="fas fa-briefcase"></i>
                </div>
                <div class="stat-content">
                    <div class="stat-number">{{ total_vacantes if total_vacantes else 0 }}+</div>
                    <div class="stat-label">Vacantes</div>
                </div>
            </div>
        </div>
    </section>

    <section class="inicio-p">
        <div class="main-content">
            <!-- Columna izquierda: perfil del usuario -->
            <div class="column left-column">
                <div class="card profile-card" data-aos="fade-up" data-aos-delay="100">
                    <div class="profile-header">
                        {% if current_user and current_user.foto_perfil %}
                            <img src="{{ current_user.foto_perfil }}" alt="Foto de perfil" class="profile-photo">
                        {% else %}
                            <div class="profile-avatar">
                                <i class="fas fa-user"></i>
                            </div>
                        {% endif %}
                    </div>
                    <div class="profile-info">
                        <h3 class="profile-name">{{ current_user.nombre if current_user else 'Invitado' }}</h3>
                        <p class="profile-email">
                            <i class="fas fa-envelope"></i>
                            {{ current_user.correo if current_user else 'No disponible' }}
                        </p>
                    </div>
                </div>
                <div class="card companies-card" data-aos="fade-up" data-aos-delay="150">
                    <div class="card-header">
                        <h3 class="card-title">
                            <i class="fas fa-trophy"></i> Empresas Destacadas
                        </h3>
                    </div>
                    <div class="companies-list">
                        {% if empresas_destacadas %}
                            {% set colores = ['blue', 'orange', 'green', 'purple'] %}
                            {% for empresa in empresas_destacadas %}
                            <div class="company-item">
                                <div class="company-avatar {{ colores[loop.index0 % 4] }}">
                                    {{ empresa.inicial }}
                                </div>
                                <div class="company-info">
                                    <div class="company-name">{{ empresa.nombre }}</div>
                                    <div class="company-vacancies">
                                        <i class="fas fa-briefcase"></i>
                                        {{ empresa.vacantes }} vacante{{ 's' if empresa.vacantes != 1 else '' }} activa{{ 's' if empresa.vacantes != 1 else '' }}
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="company-item">
                                <div class="company-avatar blue">?</div>
                                <div class="company-info">
                                    <div class="company-name">Sin empresas registradas</div>
                                    <div class="company-vacancies">0 vacantes activas</div>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Columna central: contenido principal -->
            <div class="column center-column">
                <div class="card features-card" data-aos="fade-up" data-aos-delay="150">
                    <h2 class="card-title">
                        <i class="fas fa-star"></i> ¿Por qué elegir WorkLink?
                    </h2>
                    <div class="features-grid">
                        <div class="feature-card">
                            <div class="feature-icon blue">
                                <i class="fas fa-building"></i>
                            </div>
                            <div class="feature-content">
                                <h4 class="feature-title">Empresas Locales</h4>
                                <p class="feature-text">Conexión directa con empresas de Ocosingo</p>
                            </div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon green">
                                <i class="fas fa-bolt"></i>
                            </div>
                            <div class="feature-content">
                                <h4 class="feature-title">Proceso Ágil</h4>
                                <p class="feature-text">Contratación rápida y eficiente</p>
                            </div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon purple">
                                <i class="fas fa-globe"></i>
                            </div>
                            <div class="feature-content">
                                <h4 class="feature-title">Región Completa</h4>
                                <p class="feature-text">Oportunidades en toda Chiapas</p>
                            </div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon orange">
                                <i class="fas fa-headset"></i>
                            </div>
                            <div class="feature-content">
                                <h4 class="feature-title">Soporte Personal</h4>
                                <p class="feature-text">Atención personalizada y local</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card cta-card" data-aos="fade-up" data-aos-delay="200">
                    <div class="cta-content">
                        <h3 class="cta-title">¿Listo para encontrar tu próximo empleo?</h3>
                        <p class="cta-text">Explora miles de oportunidades de trabajo en Ocosingo y alrededores</p>
                        <a href="{{ url_for('EmpleosRoute.empleos') }}" class="cta-button">
                            <i class="fas fa-arrow-right"></i> Ver Empleos Disponibles
                        </a>
                    </div>
                </div>
            </div>

            <!-- Columna derecha -->
            <div class="column right-column">
                <div class="card activity-card" data-aos="fade-up" data-aos-delay="150">
                    <div class="card-header">
                        <h3 class="card-title">
                            <i class="fas fa-chart-line"></i> Actividad Reciente
                        </h3>
                    </div>
                    <div class="activity-list">
                        {% if actividades %}
                            {% for act in actividades %}
                            <div class="activity-item {{ act.color }}">
                                <div class="activity-icon"></div>
                                <div class="activity-content">
                                    <div class="activity-title-text">{{ act.titulo }}</div>
                                    <div class="activity-description">{{ act.descripcion }}</div>
                                    <div class="activity-time">{{ act.tiempo }}</div>
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="activity-item empty">
                                <div class="activity-icon"></div>
                                <div class="activity-content">
                                    <div class="activity-title-text">Sin actividad reciente</div>
                                    <div class="activity-description">Aún no hay actividades registradas</div>
                                    <div class="activity-time">Ahora</div>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                </div>

                
            </div>
        </div>

        <!-- Llamar al componente footer -->

    </section>
    <!-- Llamar al componente footer -->
    {{ footer.footer() }}
    <!-- Inicializar AOS -->
    <script>
        AOS.init();
    </script>
    
    <!-- Service Worker -->
    <script>
        if ("serviceWorker" in navigator) {
            navigator.serviceWorker.register("/service-worker.js")
                .then(() => console.log("✅ Service Worker registrado"))
                .catch(err => console.log("❌ Error registrando SW:", err));
        }
    </script>
</body>

</html>