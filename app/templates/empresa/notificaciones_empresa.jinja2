{% import "components/flash_messages.jinja2" as flash %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Notificaciones - Empresa</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style_notificaciones.css') }}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        /* Ajustar tama√±o del contenedor para empresas */
        .notificaciones-container {
            max-width: 900px;
            margin: 2rem auto;
        }
        
        body {
            background: #f5f5f5;
        }
        
        .notificaciones-header {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
        }
    </style>
</head>
<body>
    {{ flash.render_flash_messages() }}
    
    <header style="background: linear-gradient(135deg, #1e293b 0%, #334155 100%); color: white; padding: 15px 30px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
        <div style="display: flex; align-items: center; gap: 15px;">
            <div class="logo"></div>
            <h1 style="margin: 0;"><b>WorkLink</b></h1>
        </div>
        <div style="display: flex; gap: 15px; align-items: center;">
            <a href="{{ url_for('rt_empresa.dashboard') }}" class="btn btn-sm btn-outline-light">‚Üê Volver al Dashboard</a>
            <a href="{{ url_for('IndexRoute.index') }}" class="btn btn-sm btn-danger">Salir</a>
        </div>
    </header>

    <div class="notificaciones-container">
        <div class="notificaciones-header">
            <h2>üîî Notificaciones</h2>
            {% if notificaciones %}
            <div class="header-actions">
                {% if no_leidas > 0 %}
                <span class="badge-count">{{ no_leidas }} sin leer</span>
                <form action="{{ url_for('rt_empresa.marcar_todas_leidas_empresa') }}" method="POST" style="display: inline;">
                    <button type="submit" class="btn-marcar-todas">Marcar como le√≠das</button>
                </form>
                {% endif %}
                <form action="{{ url_for('rt_empresa.eliminar_todas_notificaciones_empresa') }}" method="POST" style="display: inline;" onsubmit="return confirm('¬øEst√°s seguro de eliminar todas las notificaciones?');">
                    <button type="submit" class="btn-eliminar-todas">üóëÔ∏è Eliminar todas</button>
                </form>
            </div>
            {% endif %}
        </div>

        <div class="notificaciones-list">
            {% if notificaciones %}
                {% for notif in notificaciones %}
                <div class="notificacion-item {% if not notif.leido %}no-leida{% endif %} tipo-{{ notif.tipo }}">
                    <div class="notificacion-content">
                        <div class="notificacion-icon">
                            {% if notif.tipo == 'contratado' %}
                                üéâ
                            {% elif notif.tipo == 'en_proceso' %}
                                ‚è≥
                            {% elif notif.tipo == 'visto' %}
                                üëÅÔ∏è
                            {% elif notif.tipo == 'rechazado' %}
                                ‚ùå
                            {% elif notif.tipo == 'mensaje' %}
                                üí¨
                            {% else %}
                                üì©
                            {% endif %}
                        </div>
                        <div class="notificacion-texto">
                            <p class="mensaje">{{ notif.mensaje }}</p>
                            <span class="fecha">{{ notif.fecha_envio.strftime('%d/%m/%Y %H:%M') if notif.fecha_envio else 'Fecha desconocida' }}</span>
                        </div>
                    </div>
                    {% if not notif.leido %}
                    <form action="{{ url_for('rt_empresa.marcar_todas_leidas_empresa') }}" method="POST" class="notificacion-action">
                        <button type="submit" class="btn-marcar-leida" title="Marcar como le√≠da">‚úì</button>
                    </form>
                    {% else %}
                    <div class="notificacion-leida-icon">‚úì</div>
                    {% endif %}
                </div>
                {% endfor %}
            {% else %}
                <div class="sin-notificaciones">
                    <div class="sin-notificaciones-icon">üîï</div>
                    <h3>No tienes notificaciones</h3>
                    <p>Cuando haya actividad en tus vacantes, aparecer√°n aqu√≠.</p>
                </div>
            {% endif %}
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/notificaciones_empresa_tiempo_real.js') }}"></script>
</body>
</html>
